(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      6980,        193]
NotebookOptionsPosition[      6511,        175]
NotebookOutlinePosition[      6897,        192]
CellTagsIndexPosition[      6854,        189]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nPr", "[", 
    RowBox[{"n_", ",", "r_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"n", "!"}], "/", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "r"}], ")"}], "!"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nCr", "[", 
    RowBox[{"n_", ",", "r_"}], "]"}], ":=", 
   RowBox[{"Binomial", "[", 
    RowBox[{"n", ",", "r"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"combination", "[", 
    RowBox[{"d_", ",", "j_", ",", "pet_"}], "]"}], ":=", 
   RowBox[{"d", "*", "d", "*", 
    RowBox[{"nPr", "[", 
     RowBox[{"d", ",", "j"}], "]"}], "*", 
    RowBox[{"Power", "[", 
     RowBox[{"pet", ",", "j"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"estimateErrorRate", "[", 
    RowBox[{
    "d_", ",", "pe_", ",", "pp_", ",", "tA_", ",", "tE_", ",", "tP_", ",", 
     "pet_"}], "]"}], ":=", 
   RowBox[{"tA", "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"combination", "[", 
        RowBox[{"d", ",", "j", ",", "pet"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nCr", "[", 
           RowBox[{
            RowBox[{"i", "+", "d", "+", "j", "-", 
             RowBox[{"2", "*", "i"}]}], ",", "i"}], "]"}], "*", 
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"pe", "*", "tE"}], ",", 
            RowBox[{"(", 
             RowBox[{"d", "+", "j", "-", 
              RowBox[{"2", "*", "i"}]}], ")"}]}], "]"}], "*", 
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"pp", "*", "tP"}], ",", "i"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"d", "-", "1"}], ")"}], "/", "2"}], "+", "j", "-", 
            "1"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d", "-", "1"}], ")"}], "/", "2"}], "-", "1"}]}], "}"}]}], 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"LogPlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"estimateErrorRate", "[", 
        RowBox[{"d", ",", 
         RowBox[{"0.95", "*", 
          RowBox[{"10", "^", "logp"}]}], ",", 
         RowBox[{"0.05", "*", 
          RowBox[{"10", "^", "logp"}]}], ",", "tA", ",", "tE", ",", "tP", ",",
          "pet"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "3", ",", "9", ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"logp", ",", 
       RowBox[{"-", "5"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"tA", ",", "0", ",", "100"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"tE", ",", "1", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"tP", ",", "1", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pet", ",", "1", ",", "10"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8402714860622115`*^9, 3.840271512692026*^9}, {
  3.840276224323474*^9, 3.840276228030661*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"f047d9ff-7d66-4b9f-bb46-2e7742c59edf"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`pet$$ = 6, $CellContext`tA$$ = 
    1, $CellContext`tE$$ = 6, $CellContext`tP$$ = 6, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"\:65e0\:6807\:9898\"", Typeset`specs$$ = {{
      Hold[$CellContext`tA$$], 0, 100}, {
      Hold[$CellContext`tE$$], 1, 10}, {
      Hold[$CellContext`tP$$], 1, 10}, {
      Hold[$CellContext`pet$$], 1, 10}}, Typeset`size$$ = {
    540., {155., 163.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`tA$38975$$ = 
    0, $CellContext`tE$38976$$ = 0, $CellContext`tP$38977$$ = 
    0, $CellContext`pet$38978$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`pet$$ = 1, $CellContext`tA$$ = 
        0, $CellContext`tE$$ = 1, $CellContext`tP$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`tA$$, $CellContext`tA$38975$$, 0], 
        Hold[$CellContext`tE$$, $CellContext`tE$38976$$, 0], 
        Hold[$CellContext`tP$$, $CellContext`tP$38977$$, 0], 
        Hold[$CellContext`pet$$, $CellContext`pet$38978$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> LogPlot[
        Table[
         $CellContext`estimateErrorRate[$CellContext`d, 0.95 
          10^$CellContext`logp, 0.05 
          10^$CellContext`logp, $CellContext`tA$$, $CellContext`tE$$, \
$CellContext`tP$$, $CellContext`pet$$], {$CellContext`d, 3, 9, 
          2}], {$CellContext`logp, -5, -1}], 
      "Specifications" :> {{$CellContext`tA$$, 0, 100}, {$CellContext`tE$$, 1,
          10}, {$CellContext`tP$$, 1, 10}, {$CellContext`pet$$, 1, 10}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{612., {269., 278.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.840271502305964*^9, 3.840271514953476*^9}, 
   3.840271553100897*^9, 3.8402716202688303`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"71b51ee6-bdf4-426a-a080-d21b15078be7"]
}, Open  ]]
},
WindowSize->{1718, 1348},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
Magnification:>1.5 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (2019\:5e744\:67088\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 3242, 96, 247, "Input",ExpressionUUID->"f047d9ff-7d66-4b9f-bb46-2e7742c59edf"],
Cell[3825, 120, 2670, 52, 575, "Output",ExpressionUUID->"71b51ee6-bdf4-426a-a080-d21b15078be7"]
}, Open  ]]
}
]
*)

